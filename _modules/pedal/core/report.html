<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pedal.core.report &mdash; Pedal 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Pedal
              <img src="../../../_static/pedal-logo-v3.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../everyone/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../everyone/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../teachers/quickstart.html">Teacher Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../teachers/examples.html">Teacher Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../teachers/reference.html">Teacher Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../teachers/integrations.html">Autograder Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers/ffs.html">Developers: Feedback Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers/api.html">Developer API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers/tools.html">Developer Tools Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers/conventions.html">Internal Naming Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers/libraries.html">Necessary Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers/compilation.html">Compilation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../teachers/analysis.html">Researchers: Analyzing with Pedal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../everyone/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../everyone/contact.html">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Pedal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pedal.core.report</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pedal.core.report</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">File that holds the the Report class and the global MAIN_REPORT.</span>

<span class="sd">Note that you can make other Reports, but that doesn&#39;t actually seem to be</span>
<span class="sd">useful very often. Usually you want to just rely on the global MAIN_REPORT.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Report&#39;</span><span class="p">,</span> <span class="s1">&#39;MAIN_REPORT&#39;</span><span class="p">]</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">pedal.core.errors</span> <span class="kn">import</span> <span class="n">PedalToolNotRegistered</span><span class="p">,</span> <span class="n">PedalToolAlreadyRegistered</span>
<span class="kn">from</span> <span class="nn">pedal.core.feedback_category</span> <span class="kn">import</span> <span class="n">FeedbackCategory</span>


<span class="c1"># TODO: Mechanism for checking whether a piece of feedback is in the report</span>
<span class="kn">from</span> <span class="nn">pedal.core.formatting</span> <span class="kn">import</span> <span class="n">Formatter</span>
<span class="kn">from</span> <span class="nn">pedal.core.tool</span> <span class="kn">import</span> <span class="n">ToolRegistration</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="Report">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report">[docs]</a>
<span class="k">class</span> <span class="nc">Report</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for storing Feedback generated by Tools, along with any auxiliary</span>
<span class="sd">    data that the Tool might want to provide for other tools.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        submission (:py:class:`~pedal.core.submission.Submission`): The</span>
<span class="sd">            contextualized submission information.</span>
<span class="sd">        feedback (list[:py:class:`~pedal.core.feedback.Feedback`]): The raw</span>
<span class="sd">            feedback generated for this Report so far.</span>
<span class="sd">        suppressions (list[tuple[str, str]]): The categories and labels that</span>
<span class="sd">            have been suppressed so far.</span>
<span class="sd">        hiddens (set[str]): The parts of the final response that should be</span>
<span class="sd">            hidden. This can globally hide the &#39;correct&#39;, &#39;score&#39;, etc.</span>
<span class="sd">        group (int or str): The label for the current group. Feedback given</span>
<span class="sd">            by a Tool will automatically receive the current `group`. This</span>
<span class="sd">            is used by the Source tool, for example, in order to group feedback</span>
<span class="sd">            by sections and the :py:func:`pedal.assertions.commands.unit_test`</span>
<span class="sd">            function to combine results.</span>
<span class="sd">        group_names (dict[group, str]): A printable, student-facing name for the</span>
<span class="sd">            group. When a group needs to be rendered out to the user, this</span>
<span class="sd">            will override whatever label was going to be presented instead.</span>
<span class="sd">        hooks (dict[str, list[callable]): A dictionary mapping events to</span>
<span class="sd">            a list of callable functions. Tools can register functions on</span>
<span class="sd">            hooks to have them executed when the event is triggered by another</span>
<span class="sd">            tool. For example, the Assertions tool has hooks on the Source tool</span>
<span class="sd">            to trigger assertion resolutions before advancing to next sections.</span>
<span class="sd">        _tool_data (dict[str, Any]): Maps tool names to their data. The</span>
<span class="sd">                                       namespace for a tool can be used to</span>
<span class="sd">                                       store whatever they want, but will</span>
<span class="sd">                                       probably be in a dictionary itself.</span>
<span class="sd">        resolves (list[Any]): The result of having previously called a</span>
<span class="sd">            resolver. This allows you to check if a report has previously</span>
<span class="sd">            been resolved, or do something with that data.</span>
<span class="sd">        result (FinalFeedback): The FinalFeedback (distinct from a Feedback) that was</span>
<span class="sd">            generated as a result of resolving this Report, or None if the Report is</span>
<span class="sd">            not yet resolved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#: dict[str, dict]: The</span>
    <span class="c1">#: tools registered for this report, available via their names.</span>
    <span class="n">TOOLS</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new Report instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tool_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feedback</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignored_feedback</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suppressions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suppressed_labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hiddens</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_names</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_hooks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submission</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">Formatter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolves</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overridden_feedbacks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;New Pedal Report created.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Report.clear">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.clear">[docs]</a>
    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets the entire report back to its starting form,</span>
<span class="sd">        including deleting any attached submissions, tool data, and feedbacks.</span>
<span class="sd">        It will also reset any overridden fields of feedback classes.</span>
<span class="sd">        However, it will not affect class hooks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feedback</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignored_feedback</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suppressions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suppressed_labels</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hiddens</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tool_data</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_names</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submission</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolves</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">Formatter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_overridden_feedback</span><span class="p">()</span></div>


<div class="viewcode-block" id="Report.full_clear">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.full_clear">[docs]</a>
    <span class="k">def</span> <span class="nf">full_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This totally resets the report, including any class hooks. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_hooks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">clear_overridden_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">feedback</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overridden_feedbacks</span><span class="p">:</span>
            <span class="n">feedback</span><span class="o">.</span><span class="n">_restore_overrides</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overridden_feedbacks</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">override_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feedback_class</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overridden_feedbacks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">feedback_class</span><span class="p">)</span>

<div class="viewcode-block" id="Report.contextualize">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.contextualize">[docs]</a>
    <span class="k">def</span> <span class="nf">contextualize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">submission</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Attach the given submission to this report.</span>

<span class="sd">        Args:</span>
<span class="sd">            submission (:py:class:`pedal.core.submission.Submission`): The</span>
<span class="sd">                submission to attach to this report.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submission</span> <span class="o">=</span> <span class="n">submission</span></div>


<div class="viewcode-block" id="Report.hide_correctness">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.hide_correctness">[docs]</a>
    <span class="k">def</span> <span class="nf">hide_correctness</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Suppress the RESULT category entirely, so that the report doesn&#39;t</span>
<span class="sd">        indicate whether or not the submission was correct.</span>
<span class="sd">        TODO: Make this just a regular command.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hiddens</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;correct&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hiddens</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Report.add_feedback">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.add_feedback">[docs]</a>
    <span class="k">def</span> <span class="nf">add_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feedback</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Attaches the given feedback object to this report.</span>

<span class="sd">        Args:</span>
<span class="sd">            feedback (:py:class:`~pedal.core.feedback.Feedback`): The feedback</span>
<span class="sd">                object to attach.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~pedal.core.feedback.Feedback`: The attached feedback.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feedback</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feedback</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feedback</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span> <span class="ow">and</span> <span class="n">feedback</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">feedback</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">_get_child_feedback</span><span class="p">(</span><span class="n">feedback</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_hooks</span><span class="p">(</span><span class="s1">&#39;pedal.report&#39;</span><span class="p">,</span> <span class="s1">&#39;add_feedback&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">feedback</span><span class="p">,))</span>
        <span class="k">return</span> <span class="n">feedback</span></div>


<div class="viewcode-block" id="Report.add_ignored_feedback">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.add_ignored_feedback">[docs]</a>
    <span class="k">def</span> <span class="nf">add_ignored_feedback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">feedback</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Attaches the given feedback object to this report, but only in the</span>
<span class="sd">        ignored list. That means it should not be considered by the Resolver,</span>
<span class="sd">        since its condition did not apply to the code. Some Resolvers like</span>
<span class="sd">        to know about feedback that was not reached.</span>

<span class="sd">        Args:</span>
<span class="sd">            feedback (:py:class:`~pedal.core.feedback.Feedback`): The feedback</span>
<span class="sd">                object to attach.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~pedal.core.feedback.Feedback`: The attached feedback.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignored_feedback</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feedback</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">feedback</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">feedback</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">_get_child_feedback</span><span class="p">(</span><span class="n">feedback</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">feedback</span></div>


<div class="viewcode-block" id="Report.suppress">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.suppress">[docs]</a>
    <span class="k">def</span> <span class="nf">suppress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Suggest that an entire category or label within a category ignored by</span>
<span class="sd">        the resolver.</span>
<span class="sd">        TODO: Currently, only global suppression is supported.</span>

<span class="sd">        Args:</span>
<span class="sd">            category (str): The category of feedback to suppress.</span>
<span class="sd">            label (bool or str): A specific label to match against and suppress.</span>
<span class="sd">            fields (dict of key/values): The fields that will be matched exactly to</span>
<span class="sd">                suppress.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">category</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppressed_labels</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">suppressed_labels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">suppressed_labels</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">category</span> <span class="o">=</span> <span class="n">category</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">FeedbackCategory</span><span class="o">.</span><span class="n">ALIASES</span><span class="p">:</span>
                <span class="n">category</span> <span class="o">=</span> <span class="n">FeedbackCategory</span><span class="o">.</span><span class="n">ALIASES</span><span class="p">[</span><span class="n">category</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">category</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppressions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">suppressions</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppressions</span><span class="p">[</span><span class="n">category</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">suppressions</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">suppressions</span><span class="p">[</span><span class="n">category</span><span class="p">][</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span></div>


<div class="viewcode-block" id="Report.add_hook">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.add_hook">[docs]</a>
    <span class="k">def</span> <span class="nf">add_hook</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">function</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register the `function` to be executed when the given `event` is</span>
<span class="sd">        triggered.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            event (str): An event name. Multiple functions can be triggered for</span>
<span class="sd">                the same `event`. The format is as follows: `&quot;namespace.function.extra&quot;`</span>
<span class="sd">                The `&quot;.extra&quot;` component is optional to add further nuance, but</span>
<span class="sd">                the general idea is that you are referring to functions that,</span>
<span class="sd">                when called, should trigger other functions to be called first.</span>
<span class="sd">                The namespace is typically a tool or module.</span>
<span class="sd">            function (callable): A callable function. This function should</span>
<span class="sd">                accept a keyword parameter named `report`; this report will be passed</span>
<span class="sd">                as as that argument.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="p">)</span></div>


<div class="viewcode-block" id="Report.add_class_hook">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.add_class_hook">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_class_hook</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">function</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Similar to ``add_hook``, except attaches them to the class, so</span>
<span class="sd">        they will be executed for ALL report subclasses. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">class_hooks</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">class_hooks</span><span class="p">[</span><span class="n">event</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">class_hooks</span><span class="p">[</span><span class="n">event</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="p">)</span></div>


<div class="viewcode-block" id="Report.execute_hooks">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.execute_hooks">[docs]</a>
    <span class="k">def</span> <span class="nf">execute_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">,</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keyword_arguments</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Trigger the functions for all of the associated hooks.</span>
<span class="sd">        Hooks will be called with this report as a keyword `report` argument.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool (str): The name of the tool, to namespace events by.</span>
<span class="sd">            event_name (str): The event name (separate words with periods).</span>
<span class="sd">            arguments (tuple[any]): The arguments to be passed to the callback function.</span>
<span class="sd">            keyword_arguments (dict[str, any]): The keyword arguments to be passed to the callback funciton.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">arguments</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">keyword_arguments</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">keyword_arguments</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">event</span> <span class="o">=</span> <span class="n">tool</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">event_name</span>
        <span class="k">if</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_hooks</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_hooks</span><span class="p">[</span><span class="n">event</span><span class="p">]:</span>
                <span class="n">function</span><span class="p">(</span><span class="n">report</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">,</span> <span class="o">**</span><span class="n">keyword_arguments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">event</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hooks</span><span class="p">[</span><span class="n">event</span><span class="p">]:</span>
                <span class="n">function</span><span class="p">(</span><span class="n">report</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arguments</span><span class="p">,</span> <span class="o">**</span><span class="n">keyword_arguments</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Support retrieving a tool&#39;s data from the report using square bracket</span>
<span class="sd">        syntax. So, for example, you can do `MAIN_REPORT[&#39;tifa&#39;]` and get its</span>
<span class="sd">        data dictionary. If the tool has been registered, but not initialized</span>
<span class="sd">        for this report, then the tool will be</span>
<span class="sd">        :py:method:`pedal.core.tool.reset` first. Otherwise, throws an error</span>
<span class="sd">        that the tool does not exist.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_name (str): The formal name of the tool, most likely specified</span>
<span class="sd">                in its `constants.py` file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: The data associated with that tool.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TOOLS</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PedalToolNotRegistered</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TOOLS</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TOOLS</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">report</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_data</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the tool&#39;s current data. Should largely not be used by anyone.</span>
<span class="sd">        In fact, this could seriously damage the relationships between tools.</span>

<span class="sd">        Args:</span>
<span class="sd">            tool_name (str): The name of the tool.</span>
<span class="sd">            value (dict): The new data to set as this tool&#39;s namespace.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tool_data</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine if the given `tool_name` is available through this report.</span>
<span class="sd">        Args:</span>
<span class="sd">            tool_name (str): The name of a tool.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: Whether the tool is available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tool_data</span>

<div class="viewcode-block" id="Report.set_formatter">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.set_formatter">[docs]</a>
    <span class="k">def</span> <span class="nf">set_formatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatter</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the formatter with the new option.</span>

<span class="sd">        Args:</span>
<span class="sd">            formatter (:py:class:`pedal.core.formatting.Formatter`): The new</span>
<span class="sd">                formatter to use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">formatter</span></div>


<div class="viewcode-block" id="Report.register_tool">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.register_tool">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">register_tool</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">reset_function</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Identifies that the given Tool should be made available.</span>
<span class="sd">        Args:</span>
<span class="sd">            tool_name: A unique string identifying this tool.</span>
<span class="sd">            reset_function: The function to call to reset the Tool.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">TOOLS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PedalToolAlreadyRegistered</span><span class="p">(</span><span class="n">tool_name</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">TOOLS</span><span class="p">[</span><span class="n">tool_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ToolRegistration</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">reset_function</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">get_current_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">start_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

<div class="viewcode-block" id="Report.stop_group">
<a class="viewcode-back" href="../../../developers/api.html#pedal.core.report.Report.stop_group">[docs]</a>
    <span class="k">def</span> <span class="nf">stop_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        TODO: Should this prematurely end other groups? If so, do they get a</span>
<span class="sd">            callback event to do any wrapup?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">group</span><span class="p">)</span></div>
</div>



<span class="c1">#: The global Report object. Meant to be used as a default singleton</span>
<span class="c1">#: for any tool, so that instructors do not have to create their own Report.</span>
<span class="c1">#: Of course, all APIs are expected to work with a given Report, and only</span>
<span class="c1">#: default to this Report when no others are given.</span>
<span class="c1">#: Ideally, the average instructor will never know this exists.</span>
<span class="n">MAIN_REPORT</span> <span class="o">=</span> <span class="n">Report</span><span class="p">()</span>

<span class="c1"># TODO: Give a mechanism for &quot;freezing&quot; a report that you can keep around.</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, acbart, lukesg08.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>